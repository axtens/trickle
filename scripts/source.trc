USERBREAK ON

REM PDQ SOURCE
REM VERSION 1.0
VAR VERSION 1
VAR UPDATE 0
NOTIFY "Source.TCL V&'VAR VERSION'.&'VAR UPDATE'"

VAR ZIPFILES 1
VAR MONOSETTING 1
VAR CGASETTING 2
VAR EGASETTING 3
VAR EGAMONOSETTING 4
VAR VGASETTING 5
VAR XTSETTING 1
VAR ATSETTING 2
VAR DOS321SETTING 1
VAR DOS33SETTING 2
VAR DOSNAME DOS331

LABEL LOOP0

LABEL LOOP1
CLS
BOX 1 1 23 79
SHOWXY 1 30  "SYSTEM CONFIGURATION"
SHOWXY 3 5  "THE NEW MACHINE WILL BE SENT OUT WITH WHAT SCREEN?"
SHOWXY 5 5  "1. MONO"
SHOWXY 6 5  "2. CGA"
SHOWXY 7 5  "3. EGA"
SHOWXY 8 5  "4. EGA WITH MONO MONITOR"
SHOWXY 9 5  "5. VGA"
SHOWXY 11 5 "CHOICE: "
GOTOXY 11 12
VAR SCREEN " "
GETCHAR SCREEN
IF VAR SCREEN NI "12345"
GOTO LOOP1
ENDIF
PUTCHAR SCREEN


LABEL LOOP2
WIPE 3 5 11 60
SHOWXY 3 5  "WHAT TYPE OF MACHINE IS IT?"
SHOWXY 5 5  "1. XT"
SHOWXY 6 5  "2. AT"
SHOWXY 8 5  "CHOICE: "
GOTOXY 8 12
VAR MACHINE 0
GETCHAR MACHINE
IF VAR MACHINE NI "12"
GOTO LOOP2
ENDIF
PUTCHAR MACHINE

LABEL LOOP3
WIPE 3 5 11 60
SHOWXY 3 5  "WHICH DOS VERSION DOES IT REQUIRE?"
SHOWXY 5 5  "1. DOS 3.21"
SHOWXY 6 5  "2. DOS 3.3"
SHOWXY 8 5  "CHOICE: "
GOTOXY 8 12
VAR DOS 0
GETCHAR DOS
IF VAR DOS NI "12"
GOTO LOOP3
ENDIF
PUTCHAR DOS

IF VAR DOS EQ 1
VAR DOSNAME DOS321
ELSE
VAR DOSNAME DOS331
ENDIF

LABEL LOOP5
WIPE 3 5 11 60
SHOWXY 3 5 "WHAT CLOCK SETTING SOFTWARE IS TO BE USED?"
SHOWXY 5 5 "1. CLOCK.COM"
SHOWXY 6 5 "2. RAMCLK.COM"
SHOWXY 9 5 "CHOICE: "
GOTOXY 9 12
VAR CLOCKER 0
GETCHAR CLOCKER
IF VAR CLOCKER NI "12"
GOTO LOOP5
ENDIF
PUTCHAR CLOCKER

IF VAR CLOCKER EQ 1
VAR CLOCKPROGRAM CLOCK
ELSE
VAR CLOCKPROGRAM RAMCLK
ENDIF

WIPE 3 5 11 60
IF VAR SCREEN EQ VAR MONOSETTING
SHOWXY 3 5 "MONO SCREEN"
ENDIF
IF VAR SCREEN EQ VAR CGASETTING
SHOWXY 3 5 "CGA SCREEN"
ENDIF
IF VAR SCREEN EQ VAR EGASETTING
SHOWXY 3 5 "EGA SCREEN"
ENDIF
IF VAR SCREEN EQ VAR EGAMONOSETTING
SHOWXY 3 5 "EGA DRIVER MONO SCREEN"
ENDIF
IF VAR SCREEN EQ VAR VGASETTING
SHOWXY 3 5 "VGA SCREEN"
ENDIF
IF VAR MACHINE EQ VAR XTSETTING
SHOWXY 4 5 "XT COMPUTER"
ENDIF
IF VAR MACHINE EQ VAR ATSETTING
SHOWXY 4 5 "AT COMPUTER"
ENDIF
SHOWXY 5 5 "&'VAR DOSNAME'"
IF VAR MACHINE EQ VAR ATSETTING
SHOWXY 6 5 "AT MACHINE - NO CLOCK PROGRAMS NEEDED"
ELSE
SHOWXY 6 5 "&'VAR CLOCKPROGRAM' CLOCK PROGRAM"
ENDIF

GOTOXY 10 5
YESNO "THESE SETTINGS CORRECT (Y/N)? "
IF SYS YESNO EQ 0
GOTO LOOP0
ENDIF

CLS

IF VAR SCREEN EQ VAR MONOSETTING
CREATE "C:\PDQ\SOFTWARE\MONO.FLG"
ENDIF
IF VAR SCREEN EQ VAR CGASETTING
CREATE "C:\PDQ\SOFTWARE\CGA.FLG"
ENDIF
IF VAR SCREEN EQ VAR EGASETTING
CREATE "C:\PDQ\SOFTWARE\EGA.FLG"
ENDIF
IF VAR SCREEN EQ VAR EGAMONOSETTING
CREATE "C:\PDQ\SOFTWARE\EGAMON.FLG"
ENDIF
IF VAR SCREEN EQ VAR VGASETTING
CREATE "C:\PDQ\SOFTWARE\VGA.FLG"
ENDIF
IF VAR MACHINE EQ VAR ATSETTING
GOTO NOCLOX
ENDIF
IF VAR CLOCKER EQ 1
CREATE "C:\PDQ\SOFTWARE\CLOCK.FLG"
ENDIF
IF VAR CLOCKER EQ 2
CREATE "C:\PDQ\SOFTWARE\RAMCLK.FLG"
ENDIF
LABEL NOCLOX

REM CREATE INTERIM AUTOEXEC.BAT FILE

CREATE "C:\PDQ\SOFTWARE\AUTOEXEC.BAT"
IF VAR DOS EQ VAR DOS33SETTING
APPEND "C:\PDQ\SOFTWARE\AUTOEXEC.BAT" "@ECHO OFF"
ELSE
APPEND "C:\PDQ\SOFTWARE\AUTOEXEC.BAT" "ECHO OFF"
ENDIF
CLS "VERIFY ON"
APPEND "C:\PDQ\SOFTWARE\AUTOEXEC.BAT" "PATH C:\;C:\DOS;C:\MENU;C:\UTILS;"
IF VAR MACHINE NE VAR ATSETTING
APPEND "C:\PDQ\SOFTWARE\AUTOEXEC.BAT" "&'VAR CLOCKPROGRAM'"
ENDIF
APPEND "C:\PDQ\SOFTWARE\AUTOEXEC.BAT" CLS MENU\MENU

REM CREATE CONFIG.SYS FILE

CREATE "C:\PDQ\SOFTWARE\CONFIG.SYS"
APPEND "C:\PDQ\SOFTWARE\CONFIG.SYS" BREAK=ON FILES=20 BUFFERS=24 DEVICE=C:\DOS\ANSI.SYS LASTDRIVE=Z
APPEND "C:\PDQ\SOFTWARE\CONFIG.SYS" "SHELL=C:\DOS\COMMAND.COM C:\DOS /E:256 /P"
IF VAR DOS EQ VAR DOS321SETTING
APPEND "C:\PDQ\SOFTWARE\CONFIG.SYS" COUNTRY=061
ELSE
APPEND "C:\PDQ\SOFTWARE\CONFIG.SYS" COUNTRY=061,,C:\DOS\COUNTRY.SYS
ENDIF

REM LOAD RELEVANT DOS INTO SOFTWARE\DOS AFTER ERASING CURRENT CONTENTS

SHELL "ECHO Y | DEL C:\PDQ\SOFTWARE\DOS"
SHELL "COPY C:\PDQ\&'VAR DOSNAME' C:\PDQ\SOFTWARE\DOS"

REM INVOKE PDQ FOR TRANSFER

INVOKE "C:\PDQ\PDQ.EXE" "C:\PDQ\SOFTWARE\ /SU /S /B"

VAR BEEP1 400
VAR BEEP2 800
VAR BEEP3 1200
VAR BEEP4 1600
VAR BEEPDUR 30

VAR WAITER 7
LABEL WAITERLOOP
BEEP &'VAR BEEP1' &'VAR BEEPDUR'
BEEP &'VAR BEEP2' &'VAR BEEPDUR'
BEEP &'VAR BEEP3' &'VAR BEEPDUR'
BEEP &'VAR BEEP4' &'VAR BEEPDUR'
WAIT 125
DECVAR WAITER
IF VAR WAITER GT 0
GOTO WAITERLOOP
ENDIF

NOTIFY "SOURCE.TCL HAS COMPLETED SOFTWARE TRANSFER."
NOTIFY

REM ERASE FLAG FILES IN SOFTWARE SUBDIRECTORY

SHELL "DEL C:\PDQ\SOFTWARE\*.FLG"

HALT TARGET COMPUTER WILL NOTIFY YOU WHEN THE INSTALLATION IS COMPLETED

